<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Market Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- 三大指数的折线图 -->
        <div class="chart-container">
            <h2>三大指数近5日走势</h2>
            <canvas id="szChart"></canvas>
            <canvas id="szciChart"></canvas>
            <canvas id="cybChart"></canvas>
        </div>

        <!-- 概念资金流 -->
        <div class="fund-flow-container">
            <h3>概念资金流</h3>
            <table id="concept-fund-flow">
                <thead>
                    <tr>
                        <th>行业</th>
                        <th>流入资金 (亿)</th>
                        <th>流出资金 (亿)</th>
                        <th>净流入/流出 (亿)</th>
                    </tr>
                </thead>
                <tbody id="concept-tbody">
                    <!-- 动态加载数据 -->
                </tbody>
            </table>
        </div>

        <!-- 行业资金流 -->
        <div class="fund-flow-container">
            <h3>行业资金流</h3>
            <table id="industry-fund-flow">
                <thead>
                    <tr>
                        <th>行业</th>
                        <th>流入资金 (亿)</th>
                        <th>流出资金 (亿)</th>
                        <th>净流入/流出 (亿)</th>
                    </tr>
                </thead>
                <tbody id="industry-tbody">
                    <!-- 动态加载数据 -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // 从后端获取数据
        fetch('market_data.json')
            .then(response => response.json())
            .then(data => {
                const indicesData = data.indices;
                const conceptData = data.concept_fund_flow;
                const industryData = data.industry_fund_flow;

                // 绘制三大指数的折线图
                const szData = indicesData.map(item => item['上证指数']);
                const szciData = indicesData.map(item => item['深证成指']);
                const cybData = indicesData.map(item => item['创业板指']);
                const labels = indicesData.map(item => item['date']);

                const ctx1 = document.getElementById('szChart').getContext('2d');
                const ctx2 = document.getElementById('szciChart').getContext('2d');
                const ctx3 = document.getElementById('cybChart').getContext('2d');

                new Chart(ctx1, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: '上证指数',
                            data: szData,
                            borderColor: 'rgba(255, 99, 132, 1)',
                            fill: false
                        }]
                    }
                });

                new Chart(ctx2, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: '深证成指',
                            data: szciData,
                            borderColor: 'rgba(54, 162, 235, 1)',
                            fill: false
                        }]
                    }
                });

                new Chart(ctx3, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: '创业板指',
                            data: cybData,
                            borderColor: 'rgba(75, 192, 192, 1)',
                            fill: false
                        }]
                    }
                });

                // 动态加载概念资金流数据
                const conceptTableBody = document.getElementById('concept-tbody');
                conceptData.forEach(item => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${item.行业}</td>
                        <td>${item.流入资金}</td>
                        <td>${item.流出资金}</td>
                        <td>${item['净流入/流出']}</td>
                    `;
                    conceptTableBody.appendChild(row);
                });

                // 动态加载行业资金流数据
                const industryTableBody = document.getElementById('industry-tbody');
                industryData.forEach(item => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${item.行业}</td>
                        <td>${item.流入资金}</td>
                        <td>${item.流出资金}</td>
                        <td>${item['净流入/流出']}</td>
                    `;
                    industryTableBody.appendChild(row);
                });
            })
            .catch(error => console.error('Error loading market data:', error));
    </script>
</body>
</html>
